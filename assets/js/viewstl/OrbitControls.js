THREE.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*l.autoRotateSpeed}function o(){return Math.pow(.95,l.zoomSpeed)}function a(e){if(!1!==l.enabled){if(e.preventDefault(),0===e.button){if(!0===l.noRotate)return;V=N.ROTATE,E.set(e.clientX,e.clientY)}else if(1===e.button){if(!0===l.noZoom)return;V=N.DOLLY,O.set(e.clientX,e.clientY)}else if(2===e.button){if(!0===l.noPan)return;V=N.PAN,b.set(e.clientX,e.clientY)}l.domElement.addEventListener("mousemove",i,!1),l.domElement.addEventListener("mouseup",s,!1),l.dispatchEvent(D)}}function i(e){if(!1!==l.enabled){e.preventDefault();var t=l.domElement===document?l.domElement.body:l.domElement;if(V===N.ROTATE){if(!0===l.noRotate)return;m.set(e.clientX,e.clientY),f.subVectors(m,E),l.rotateLeft(2*Math.PI*f.x/t.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*f.y/t.clientHeight*l.rotateSpeed),E.copy(m)}else if(V===N.DOLLY){if(!0===l.noZoom)return;R.set(e.clientX,e.clientY),H.subVectors(R,O),H.y>0?l.dollyIn():l.dollyOut(),O.copy(R)}else if(V===N.PAN){if(!0===l.noPan)return;y.set(e.clientX,e.clientY),T.subVectors(y,b),l.pan(T.x,T.y),b.copy(y)}l.update()}}function s(){!1!==l.enabled&&(l.domElement.removeEventListener("mousemove",i,!1),l.domElement.removeEventListener("mouseup",s,!1),l.dispatchEvent(j),V=N.NONE)}function c(e){if(!1!==l.enabled&&!0!==l.noZoom){e.preventDefault();var t=0;e.wheelDelta!==undefined?t=e.wheelDelta:e.detail!==undefined&&(t=-e.detail),t>0?l.dollyOut():l.dollyIn(),l.update(),l.dispatchEvent(D),l.dispatchEvent(j)}}function r(e){if(!1!==l.enabled&&!0!==l.noKeys&&!0!==l.noPan)switch(e.keyCode){case l.keys.UP:l.pan(0,l.keyPanSpeed),l.update();break;case l.keys.BOTTOM:l.pan(0,-l.keyPanSpeed),l.update();break;case l.keys.LEFT:l.pan(l.keyPanSpeed,0),l.update();break;case l.keys.RIGHT:l.pan(-l.keyPanSpeed,0),l.update()}}function d(e){if(!1!==l.enabled){switch(e.touches.length){case 1:if(!0===l.noRotate)return;V=N.TOUCH_ROTATE,E.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!0===l.noZoom)return;V=N.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);O.set(0,o);break;case 3:if(!0===l.noPan)return;V=N.TOUCH_PAN,b.set(e.touches[0].pageX,e.touches[0].pageY);break;default:V=N.NONE}l.dispatchEvent(D)}}function h(e){if(!1!==l.enabled){e.preventDefault(),e.stopPropagation();var t=l.domElement===document?l.domElement.body:l.domElement;switch(e.touches.length){case 1:if(!0===l.noRotate)return;if(V!==N.TOUCH_ROTATE)return;m.set(e.touches[0].pageX,e.touches[0].pageY),f.subVectors(m,E),l.rotateLeft(2*Math.PI*f.x/t.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*f.y/t.clientHeight*l.rotateSpeed),E.copy(m),l.update();break;case 2:if(!0===l.noZoom)return;if(V!==N.TOUCH_DOLLY)return;var n=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(n*n+o*o);R.set(0,a),H.subVectors(R,O),H.y>0?l.dollyOut():l.dollyIn(),O.copy(R),l.update();break;case 3:if(!0===l.noPan)return;if(V!==N.TOUCH_PAN)return;y.set(e.touches[0].pageX,e.touches[0].pageY),T.subVectors(y,b),l.pan(T.x,T.y),b.copy(y),l.update();break;default:V=N.NONE}}}function u(){!1!==l.enabled&&(l.dispatchEvent(j),V=N.NONE)}this.object=e,this.domElement=t!==undefined?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=Infinity,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var l=this,p=1e-6,E=new THREE.Vector2,m=new THREE.Vector2,f=new THREE.Vector2,b=new THREE.Vector2,y=new THREE.Vector2,T=new THREE.Vector2,v=new THREE.Vector3,g=new THREE.Vector3,O=new THREE.Vector2,R=new THREE.Vector2,H=new THREE.Vector2,L=0,P=0,M=1,w=new THREE.Vector3,k=new THREE.Vector3,N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},V=N.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var Y={type:"change"},D={type:"start"},j={type:"end"};this.rotateLeft=function(e){e===undefined&&(e=n()),P-=e},this.rotateUp=function(e){e===undefined&&(e=n()),L-=e},this.panLeft=function(e){var t=this.object.matrix.elements;v.set(t[0],t[1],t[2]),v.multiplyScalar(-e),w.add(v)},this.panUp=function(e){var t=this.object.matrix.elements;v.set(t[4],t[5],t[6]),v.multiplyScalar(e),w.add(v)},this.pan=function(e,t){var n=l.domElement===document?l.domElement.body:l.domElement;if(l.object.fov!==undefined){var o=l.object.position.clone().sub(l.target).length();o*=Math.tan(l.object.fov/2*Math.PI/180),l.panLeft(2*e*o/n.clientHeight),l.panUp(2*t*o/n.clientHeight)}else l.object.top!==undefined?(l.panLeft(e*(l.object.right-l.object.left)/n.clientWidth),l.panUp(t*(l.object.top-l.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){e===undefined&&(e=o()),M/=e},this.dollyOut=function(e){e===undefined&&(e=o()),M*=e},this.update=function(){var e=this.object.position;g.copy(e).sub(this.target);var t=Math.atan2(g.x,g.z),o=Math.atan2(Math.sqrt(g.x*g.x+g.z*g.z),g.y);this.autoRotate&&this.rotateLeft(n()),t+=P,o+=L,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(p,Math.min(Math.PI-p,o));var a=g.length()*M;a=Math.max(this.minDistance,Math.min(this.maxDistance,a)),this.target.add(w),g.x=a*Math.sin(o)*Math.sin(t),g.y=a*Math.cos(o),g.z=a*Math.sin(o)*Math.cos(t),e.copy(this.target).add(g),this.object.lookAt(this.target),P=0,L=0,M=1,w.set(0,0,0),k.distanceTo(this.object.position)>0&&(this.dispatchEvent(Y),k.copy(this.object.position))},this.reset=function(){V=N.NONE,this.target.copy(this.target0),this.update()},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",c,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("touchstart",d,!1),this.domElement.addEventListener("touchend",u,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",r,!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);